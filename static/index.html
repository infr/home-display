<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Automation</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="container">
      <!-- Car Control Column (1/3) -->
      <div class="sidebar">
        <div id="clock" class="clock"></div>
        <div id="weather" class="weather sidebar-section"></div>
        <div class="car sidebar-section">
          <div class="car-info-panel" id="bmwPanel">
            <div class="car-main-row">
              <div class="car-status-column">
                <div class="connection-badge disconnected" id="bmwConnection">
                  <span class="connection-dot"></span>
                  <span class="connection-text">Offline</span>
                </div>
                <div class="car-status-card" id="bmwStatusInfo" style="display: none;">
                  <div class="status-item">
                    <div class="battery-indicator">
                      <div class="battery-icon">
                        <div class="battery-level" id="bmwBatteryLevel"></div>
                      </div>
                      <span class="battery-percentage" id="bmwBatteryPercent">--</span>
                    </div>
                  </div>
                  <div class="status-item" id="bmwChargingStatus">
                    <span class="status-text">Not charging</span>
                  </div>
                  <div class="status-item">
                    <span class="status-label">Range:</span>
                    <span class="range-value" id="bmwRange">-- km</span>
                  </div>
                  <div class="status-item" id="bmwRemoteStatus" style="display: none;">
                    <span class="status-text" id="bmwRemoteText"></span>
                  </div>
                </div>
              </div>
              <img src="330.png" alt="BMW Photo" onclick="drive(this)" class="car-image" />
            </div>
            <div class="controls">
              <div class="control-button" onclick="controlBMW('climate', this)">üî•</div>
              <div class="control-button" onclick="controlBMW('flash', this)">üí°</div>
              <div class="control-button lock-button" id="bmwLockStatus" onclick="controlBMW('lock', this)">üîí</div>
              <div class="control-button" onclick="controlBMW('unlock', this)">üîì</div>
            </div>
          </div>
        </div>
        <div class="car sidebar-section">
          <div class="car-info-panel" id="mitsubishiPanel">
            <div class="car-main-row">
              <div class="car-status-column">
                <div class="connection-badge disconnected" id="mitsubishiConnection">
                  <span class="connection-dot"></span>
                  <span class="connection-text">Offline</span>
                </div>
                <div class="car-status-card" id="mitsubishiStatusInfo" style="display: none;">
                  <div class="status-item">
                    <div class="battery-indicator">
                      <div class="battery-icon">
                        <div class="battery-level" id="mitsubishiBatteryLevel"></div>
                      </div>
                      <span class="battery-percentage" id="mitsubishiBatteryPercent">--</span>
                    </div>
                  </div>
                  <div class="status-item" id="mitsubishiChargingStatus">
                    <span class="status-text">Not charging</span>
                  </div>
                  <div class="status-item">
                    <span class="status-label">Range:</span>
                    <span class="range-value" id="mitsubishiRange">-- km</span>
                  </div>
                  <div class="status-item" id="mitsubishiRemoteStatus" style="display: none;">
                    <span class="status-text" id="mitsubishiRemoteText"></span>
                  </div>
                </div>
              </div>
              <img src="outlander.png" alt="Outlander Photo" onclick="driveToChart(this)" class="car-image" />
            </div>
            <div class="controls">
              <div class="control-button" onclick="controlOutlander('remoteHeating', this)">üî•</div>
              <div class="control-button" onclick="controlOutlander('lights', this)">üí°</div>
            </div>
          </div>
        </div>
      </div>

      <!-- External Content Column (2/3) -->
      <div class="iframe-container" id="electricity-container">
        <div class="test-mode-indicator" id="testModeIndicator">TEST MODE</div>
        <canvas id="electricityChart"></canvas>
      </div>
    </div>

    <!-- Settings Button -->
    <button class="settings-button" onclick="openSettings()">‚öôÔ∏è</button>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeSettings()">&times;</span>
        <div class="modal-body">
          <div class="modal-column">
            <div class="setting-item">
              <label for="darkModeSelect">Theme</label>
              <select id="darkModeSelect" onchange="updateDarkMode()">
                <option value="light">Light</option>
                <option value="dark">Dark</option>
                <option value="auto">Auto (19:00-06:00)</option>
              </select>
            </div>
            <div class="setting-item">
              <label for="maxValue">Max Price Value (c/kWh)</label>
              <input type="number" id="maxValue" value="30" min="10" max="100" onchange="updateMaxValue()">
            </div>
            <div class="setting-item">
              <label for="carStatusInterval">Car Status Update (minutes)</label>
              <input type="number" id="carStatusInterval" value="5" min="1" max="60" onchange="updateCarStatusInterval()">
            </div>
            <div class="setting-item">
              <label for="weatherInterval">Weather Update (minutes)</label>
              <input type="number" id="weatherInterval" value="15" min="5" max="120" onchange="updateWeatherInterval()">
            </div>
            <div class="setting-item">
              <label class="toggle">
                <input type="checkbox" id="testModeToggle" onchange="toggleTestMode()">
                <span>Test Mode (Random Data)</span>
              </label>
            </div>
            <div class="setting-item">
              <label class="toggle">
                <input type="checkbox" id="disableBMWToggle" onchange="toggleDisableBMW()">
                <span>Disable BMW</span>
              </label>
            </div>
            <div class="setting-item">
              <label class="toggle">
                <input type="checkbox" id="disableMitsubishiToggle" onchange="toggleDisableMitsubishi()">
                <span>Disable Mitsubishi</span>
              </label>
            </div>
            <div class="setting-item">
              <button onclick="resetSettings()" class="action-button" style="width: 100%;">Reset All Settings</button>
            </div>
          </div>
          <div class="modal-column logs">
            <div class="setting-item">
              <div id="output" class="log-output"></div>
              <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px; margin-top: 4px;">
                <button onclick="clearDebugLogs()" class="action-button">Clear Log</button>
                <button onclick="killBrowser()" class="action-button">Kill Browser</button>
                <button onclick="redeploy()" class="action-button">Redeploy</button>
                <button onclick="rebootSystem()" class="action-button">Reboot</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript Files -->
    <script src="settings.js"></script>
    <script src="electricity.js"></script>
    <script src="car.js"></script>
    <script src="utils.js"></script>
  </body>
</html>
